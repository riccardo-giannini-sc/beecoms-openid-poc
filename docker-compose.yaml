version: "3"

services:
    serverapp:
        depends_on:
            - db
        build: ./serverapp
        ports:
            - 8000:8000
        volumes:
            - ./serverapp:/app
    layer:
        depends_on:
            - db
        build: ./layer
        ports:
            - 8001:8001
        volumes:
            - ./layer:/app
    prm:
        depends_on:
            - db
        build: ./prm
        ports:
            - 8002:8002
        restart: always
        volumes:
            - ./prm:/app
    db:
        image: mysql
        volumes:
            - db_data:/var/lib/mysql
            - ./mysql/init:/docker-entrypoint-initdb.d
        restart: always
        environment:
            MYSQL_ROOT_PASSWORD: password
    adminer:
        depends_on:
            - db
        image: adminer
        restart: always
        ports:
            - 8084:8080
volumes:
    db_data: {}