<?

require_once "config.php";

if (!$_COOKIE['logged_in_app']) {
    header("Location: /login_app.php");
    exit();
}

if ($_POST['username'] && $_POST['password']) {
    if ($_POST['test-always-fail']) {
        $error = "Spiacente, non sei autenticato";
    } else {
        setcookie("logged_in_app", true);
        header("Location: /login_prm.php");
        exit();
    }
}

ob_start();

?>

<h1>Login in App</h1>

<form action="login_app.php" method="POST">
<label for="username">Username:</label>
<input name="username" type="text" placeholder="username">
<br/>
<label for="password">Password:</label>
<input name="password" type="password" placeholder="password">
<br/>
<label for="test-always-fail">Test: if checked, the login always fails:</label>
<input name="test-always-fail" type="checkbox" value="1">
<br/>
<button>Login in PRM</button>
<br/>
<span style="color:red"><?=$error ?? ''?></span>
<br/>
</form>

<?
$content = ob_get_contents();
ob_end_clean();

require_once "index.php";